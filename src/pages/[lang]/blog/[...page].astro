---
import type { InferGetStaticPropsType, GetStaticPaths } from 'astro';
import Layout from '~/layouts/PageLayout.astro';
import BlogList from '~/components/blog/List.astro';
import Headline from '~/components/blog/Headline.astro';
import Pagination from '~/components/blog/Pagination.astro';

// FIX: blogListRobots hier importieren!
import { fetchPosts, blogPostsPerPage, blogListRobots } from '~/utils/blog'; 

export const prerender = true;

export const getStaticPaths = (async ({ paginate }) => {
  const LANGUAGES = ['en', 'de'];

  const paths = await Promise.all(
    LANGUAGES.map(async (lang) => {
      const langPosts = await fetchPosts(lang);
      return paginate(langPosts, {
        params: { lang },
        pageSize: blogPostsPerPage || 6,
      });
    })
  );

  return paths.flat();
}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { page } = Astro.props;
const { lang } = Astro.params;

const currentPage = page.currentPage ?? 1;

const metadata = {
  title: `Blog ${currentPage > 1 ? ` â€” Page ${currentPage}` : ''}`,
  robots: {
    // Jetzt kennt er die Variable
    index: blogListRobots?.index && currentPage === 1,
    follow: blogListRobots?.follow,
  },
  openGraph: {
    type: 'blog',
  },
};
---

<Layout metadata={metadata}>
   </Layout>
