---
import { getI18nPaths, useTranslations } from '~/i18n/utils';
import { getFooterData } from '~/navigation';

import Layout from '~/layouts/PageLayout.astro';
import HeroText from '~/components/widgets/HeroText.astro';
import Prices from '~/components/widgets/Pricing.astro';
import FAQs from '~/components/widgets/FAQs.astro';
import Steps from '~/components/widgets/Steps.astro';
import Features3 from '~/components/widgets/Features3.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';

// 1️⃣ Static Paths
export async function getStaticPaths() {
  return getI18nPaths();
}

// 2️⃣ Sprache & Übersetzungen
const { lang } = Astro.params;
const t = useTranslations(lang); // intern fallback auf DEFAULT_LANG

// 3️⃣ FAQ Items mit exakter Reihenfolge
const faqOrderConfig = [
  { key: 'faq.performance.items', index: 0 },
  { key: 'faq.performance.items', index: 1 },
  { key: 'faq.performance.items', index: 2 },
  { key: 'faq.started.items', index: 0 },
  { key: 'faq.started.items', index: 1 },
  { key: 'faq.performance.items', index: 3 },
  { key: 'faq.security.items', index: 0 },
  { key: 'faq.billing.items', index: 0 },
  { key: 'faq.billing.items', index: 1 },
  { key: 'faq.support.items', index: 0 },
];

const selectedFAQItems = faqOrderConfig
  .map(({ key, index }) => {
    const items = t(key) || [];
    return items[index];
  })
  .filter(Boolean);

// 4️⃣ Metadata
const metadata = {
  title: `${t('home.hero.titleStart')} ${t('home.hero.titleAccent')} — AmendLogic`,
  ignoreTitleTemplate: true,
};

// 5️⃣ Footer Data
const footerData = getFooterData(lang, ['payments']);
---

<Layout metadata={metadata} footerData={footerData}>
  <!-- HeroText Widget ******************* -->

  <HeroText
    tagline={t('pricing.hero.tagline')}
    title={t('pricing.hero.title')}
    subtitle={t('pricing.hero.subtitle')}
  />

  <!-- Pricing Widget ******************* -->

  <Prices
    id="prices'
    title={t('pricing.title')}
    subtitle={t('pricing.subtitle')}
    prices={t('pricing.prices')}
  />

  <!-- Features3 Widget ************** -->

  <Features3
    title={t('pricing.trust.title')}
    subtitle={t('pricing.trust.subtitle')}
    columns={2}
    items={t('pricing.trust.items')}
    classes={{ container: 'max-w-5xl' }}
  />

  <!-- Steps Widget ****************** -->

  <Steps
    tagline={t('pricing.steps.tagline')}
    title={t('pricing.steps.title')}
    isReversed={true}
    items={t('pricing.steps.items')}
    image={{
      src: 'https://images.unsplash.com/photo-1536816579748-4ecb3f03d72a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=987&q=80',
      alt: 'Steps image',
    }}
  />

  <!-- FAQs Widget ******************* -->

  <FAQs
    title="Pricing FAQs"
    subtitle="Choosing the right plan is important, and we're here to answer your questions. If you have queries about our pricing options, you're in the right place."
    columns={1}
    items={[
      {
        title: 'Do the plans come with customer support?',
        description:
          'Absolutely, all plans include access to our dedicated customer support to assist you with any queries or concerns.',
      },
      {
        title: 'Is there a trial period for the different plans?',
        description:
          "Unfortunately, we don't offer trial periods for the plans. However, you can check out our demo section to preview the quality of our templates.",
      },
      {
        title: 'Can I switch between plans?',
        description:
          'Certainly! You can easily upgrade or downgrade your plan, at any time, to find the one that best suits your evolving requirements.',
      },
      {
        title: 'What payment methods do you accept?',
        description:
          'We accept major credit cards and online payment methods to ensure a convenient and secure transaction process.',
      },
      {
        title: 'Are there any hidden fees beyond the displayed cost?',
        description:
          'No, the subscription cost covers all the features and templates listed under each plan. There are no hidden fees or extra charges.',
      },
    ]}
  />

  <!-- CallToAction Widget *********** -->

  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: t('pricing.cta.btnText'),
        href: '#prices',
        target: '_self',
        icon: 'tabler:chevron-up',
      },
    ]}
  >
    <Fragment slot="title">
      {t('pricing.cta.title')}
    </Fragment>
    <Fragment slot="subtitle">
      {t('pricing.cta.subtitle')}
    </Fragment>
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-blue-50 dark:bg-transparent"></div>
    </Fragment>
  </CallToAction>

</Layout>
