---
import { getI18nPaths, DEFAULT_LANG, useTranslations } from '~/i18n/utils';

// 1. Daten und Navigation importieren
import { getFooterData } from '~/navigation';

// Layout & Widgets
import Layout from '~/layouts/PageLayout.astro';
import Hero from '~/components/widgets/Hero.astro';
import Note from '~/components/widgets/Note.astro';
import Content from '~/components/widgets/Content.astro';
import Steps from '~/components/widgets/Steps.astro';
import EChart from '~/components/widgets/EChart.astro';
import Testimonials from '~/components/widgets/Testimonials.astro';
import FAQs from '~/components/widgets/FAQs.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';

// 2. Pfade generieren (SSOT für [lang])
export async function getStaticPaths() {
  return getI18nPaths();
}

// 3. Sprache & Content laden
const { lang } = Astro.params;
const t = useTranslations(lang);

// 4. Footer zusammenbauen
const baseFooterData = getFooterData(lang);
const disclaimerItems = t('footer.footerDisclaimer');

const homeFooterData = {
  ...baseFooterData,
  disclaimer: disclaimerItems
};

// 5. Metadaten
const metadata = {
  title: `${t('home.hero.titleStart')} ${t('home.hero.titleAccent')} — AmendLogic`,
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata} footerData={homeFooterData}>

  <Hero
    image={{ src: '~/assets/images/hero-image.png', alt: 'AstroWind Hero Image' }}
  >
    <Fragment slot="actions">
      <a href="https://github.com/arthelokyo/astrowind" target="_blank" class="btn btn-primary inline-flex items-center gap-2">
        {t('home.hero.btnPrimary')}
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 1 59 59" class="w-10 h-10 ml-1 -mr-1.5 rtl:mr-1 rtl:-ml-1.5 inline-block">
          <path d="M33 17c-3.5 0-6.3 2.85-6.35 6.35 0 3.5 2.85 6.35 6.35 6.35s6.35-2.85 6.35-6.35S36.5 17 33 17ZM45.7 45.5 57.6 17H44.95L33.05 45.5H45.7Zm-22.25 0V17H1.3V28.1H12.4V45.5H23.5Z" fill="#FFFFFF"/>
        </svg>
      </a>
      <a href="#features" class="btn btn-secondary">
        {t('home.hero.btnSecondary')}
      </a>
    </Fragment>

    <Fragment slot="title">
      {t('home.hero.titleStart')}
      <span class="text-accent dark:text-white"> {t('home.hero.titleAccent')}</span> {t('home.hero.titleEnd')}
    </Fragment>

    <Fragment slot="subtitle">
      <span class="block mb-1 font-bold text-blue-600">{t('home.hero.tagline')}</span>
      {t('home.hero.subtitle')}
    </Fragment>
  </Hero>

  <Note 
    title={t('home.note.title')} 
    description={t('home.note.desc')} 
  />

  <Content
    isReversed
    id="features"
    tagline={t('home.features1.tagline')}
    title={t('home.features1.title')}
    items={t('home.features1.items')} 
    image={{
      src: 'https://images.unsplash.com/photo-1519389950473-47ba0277781c?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
      alt: 'Colorful Image',
    }}
  >
    <Fragment slot="content">
      <h3 class="text-2xl font-bold tracking-tight dark:text-white sm:text-3xl mb-2">
        {t('home.features1.contentTitle')}
      </h3>
      {t('home.features1.contentDesc')}
    </Fragment>
  </Content>

  <Content
    isAfterContent
    items={t('home.features2.items')}
    image={{
      src: 'https://images.unsplash.com/photo-1600132806370-bf17e65e942f?ixlib=rb-4.0.3&auto=format&fit=crop&w=2194&q=80',
      alt: 'Blueprint Image',
    }}
  >
    <Fragment slot="content">
      <h3 class="text-2xl font-bold tracking-tight dark:text-white sm:text-3xl mb-2">
        {t('home.features2.contentTitle')}
      </h3>
      {t('home.features2.contentDesc')}
    </Fragment>
  </Content>

  <Steps
    tagline={t('home.steps.tagline')}
    title={t('home.steps.title')}
    subtitle={t('home.steps.subtitle')}
    isReversed={true}
    items={t('home.steps.items')}
    image={{
      src: 'https://images.unsplash.com/photo-1616198814651-e71f960c3180?ixlib=rb-4.0.3&auto=format&fit=crop&w=987&q=80',
      alt: 'Steps image',
    }}
  />

  <EChart
    tagline={t('home.chart.tagline')}
    title={t('home.chart.title')}
    subtitle={t('home.chart.subtitle')}
    height="400px"
    options={{
      tooltip: { trigger: "axis", valueFormatter: v => `${v}%` },
      legend: { data: ["AmendLogic", "Buy & Hold", "Drawdown"] },
      xAxis: { type: "category", data: ["2016", "2017", "2018", "2019", "2020", "2021", "2022", "2023", "2024", "2025", "2026"] },
      yAxis: [
        { type: "value", name: "Equity %", position: "left", axisLabel: { formatter: "{value}%" } },
        { type: "value", name: "Drawdown %", position: "right", min: -100, max: 0, axisLabel: { formatter: "{value}%" } }
      ],
      series: [
        { name: "AmendLogic", type: "line", smooth: true, data: [0, 35, 120, 90, 160, 210, 210, 210, 210, 210, 210], lineStyle: { width: 3 } },
        { name: "Buy & Hold", type: "line", smooth: true, data: [0, 20, 95, 40, 110, 180], lineStyle: { type: "dashed" } },
        { name: "Drawdown", type: "bar", yAxisIndex: 1, data: [0, -12, -35, -55, -18, -10, -10, -10, -10, -10, -10], itemStyle: { color: "rgba(239,68,68,0.5)" } }
      ]
    }}
  />

  <Testimonials
    tagline={t('home.testimonials.tagline')}
    title={t('home.testimonials.title')}
    testimonials={t('home.testimonials.items').map(item => ({
      ...item,
      image: { src: item.image, alt: item.name }
    }))}
    callToAction={{
      target: '_blank',
      text: t('home.testimonials.btnText'),
      href: 'https://github.com/arthelokyo/astrowind',
      icon: 'tabler:chevron-right',
    }}
  />

  <FAQs
    title={t('home.faqs.title')}
    subtitle={t('home.faqs.subtitle')}
    tagline={t('home.faqs.tagline')}
    classes={{ container: 'max-w-6xl' }}
    items={t('home.faqs.items')}
  />

  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: t('home.cta.btnText'),
        href: 'https://github.com/arthelokyo/astrowind',
        target: '_blank',
        icon: 'tabler:download',
      },
    ]}
  >
    <Fragment slot="title">
      {t('home.cta.title')}
    </Fragment>
    <Fragment slot="subtitle">
      {t('home.cta.subtitle')}
    </Fragment>
    <Fragment slot="bg">
      <div class="absolute inset-0 bg-blue-50 dark:bg-transparent"></div>
    </Fragment>
  </CallToAction>

</Layout>
