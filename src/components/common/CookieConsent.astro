---
/* src/components/common/CookieConsent.astro */
---

<link rel="stylesheet" href="/libs/cookieconsent.css" />
<link rel="stylesheet" href="/libs/cookie-custom.css" />

<script is:inline src="/libs/cookieconsent.umd.js"></script>

<script is:inline>
async function initCookieBanner() {
  if (!window.CookieConsent) {
    setTimeout(initCookieBanner, 100);
    return;
  }

  try {
    const { config } = await import('/libs/cookieconsent-config.js');

    // ðŸ‘‰ Sprache kommt NUR aus <html lang="...">
    const currentLang =
      document.documentElement.lang?.split('-')[0] || 'de';

    window.CookieConsent.run({
      ...config,
      language: {
        ...config.language,
        current: currentLang
      }
    });

  } catch (e) {
    console.error("CookieConsent Fehler:", e);
  }
}

document.addEventListener('astro:page-load', initCookieBanner);
</script>