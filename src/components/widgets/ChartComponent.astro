---
interface Props {
  width?: string;
  height?: string;
  options?: Record<string, any>;
}

const { width = "100%", height = "400px", options } = Astro.props;

const chartId = `echart-${Math.random().toString(36).slice(2)}`;

const chartOptions = options ?? {
  title: { text: "ECharts Example" },
  tooltip: {},
  xAxis: { data: ["A", "B", "C", "D", "E"] },
  yAxis: {},
  series: [
    { type: "bar", data: [5, 20, 36, 10, 10] }
  ]
};
---

<div id={chartId} style={`width:${width};height:${height};`}></div>

<script type="module" is:inline>
  import * as echarts from "https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.esm.min.js";

  const el = document.getElementById("{chartId}");
  if (!el) {
    console.error("ECharts container not found");
  }

  const chart = echarts.init(el);
  chart.setOption({chartOptions});

  window.addEventListener("resize", () => chart.resize());
</script>